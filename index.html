<!doctype html><html><body>
<h2>TKG Bank</h2>
<div id=b>---</div>
<input id=a placeholder="送金額"><button onclick=t()>送金</button>
<script>
let token,refresh;
async function login(){
  const r=await fetch("/api/auth",{method:"POST",headers:{'Content-Type':'application/json'},
  body:JSON.stringify({address:"OWNER",signature:crypto("OWNERLOGIN")})});
  ({token,refresh}=await r.json());balance();
}
async function balance(){
  const r=await fetch("/api/balance",{headers:{Authorization:"Bearer "+token}});
  document.getElementById("b").innerText=(await r.json()).balance;
}
async function t(){
  await fetch("/api/transfer",{method:"POST",headers:{'Content-Type':'application/json',Authorization:"Bearer "+token},
  body:JSON.stringify({amount:+a.value})});balance();
}
function crypto(s){return [...s].reduce((a,c)=>a+c.charCodeAt(0),"")}
login();
</script></body></html>
