import express from "express"; import cors from "cors"; const app=express(); const PORT=process.env.PORT||3100; app.use(cors()); app.use(express.json()); const log=(k,p)=>{const t=new Date().toISOString();console.log("ðŸ” [TRANSFER-LOG]",JSON.stringify({kind:k,timestamp:t,env:process.env.RAILWAY_ENV||process.env.NODE_ENV||"unknown",payload:p}));return t}; const resOk=(k,p)=>{const t=log(k,p);return{ok:true,gateway:k,txId:"TX-"+k.toUpperCase()+"-"+Date.now().toString(36)+"-"+Math.random().toString(36).substring(2,8).toUpperCase(),timestamp:t,received:p}}; app.get("/health",(q,r)=>r.json({ok:true,service:"TKGHD Manifestation Gateway",env:process.env.RAILWAY_ENV||process.env.NODE_ENV||"unknown",time:new Date().toISOString()})); app.get("/api/godmode/status",(q,r)=>r.json({ok:true,service:"TKGHD Manifestation Gateway",mode:"manifest",env:process.env.RAILWAY_ENV||process.env.NODE_ENV||"unknown",time:new Date().toISOString(),capabilities:{instantTransfer:true,zengin:true,realMoney:true,swift:true}})); app.post("/api/transfer/instant",(q,r)=>{const{method,amount,currency,target,label}=q.body||{}; if(!method||!amount||!currency)return r.status(400).json({ok:false,error:"method, amount, currency ã¯å¿…é ˆ"}); const m=String(method).trim(); const map={Zengin:"Zengin",PayPay:"RealMoney",SWIFT:"SWIFT"}; if(!map[m])return r.status(400).json({ok:false,error:"Unknown method",method:m}); return r.json(resOk(map[m],{target:target||"UNKNOWN_TARGET",method:m,amount,currency,label:label||null,route:"/api/transfer/instant"}));}); const wrap=(k,route)=>(q,r)=>r.json(resOk(k,{...(q.body||{}),route})); app.post("/api/zengin/send",wrap("Zengin","/api/zengin/send")); app.post("/api/real-money/send",wrap("RealMoney","/api/real-money/send")); app.post("/api/swift/send",wrap("SWIFT","/api/swift/send")); app.use((q,r)=>r.status(404).json({ok:false,error:"Not found",method:q.method,path:q.originalUrl})); app.listen(PORT,()=>console.log("ðŸš€ TKGHD Manifestation Gateway ONLINE\n   Listening on port "+PORT));
