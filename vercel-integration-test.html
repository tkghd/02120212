<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TKG Ultimate - å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen text-white">
  <div class="container mx-auto p-6 max-w-6xl">
    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="bg-gradient-to-r from-blue-600 to-purple-600 rounded-3xl p-8 mb-6 shadow-2xl">
      <h1 class="text-4xl font-bold mb-2">ğŸš€ TKG Ultimate Transfer System</h1>
      <p class="text-blue-100">å®Œå…¨çµ±åˆãƒ†ã‚¹ãƒˆ - UI â†’ Railway API â†’ REALå£åº§</p>
      <div class="mt-4 flex gap-4 items-center">
        <div id="status" class="flex items-center gap-2">
          <div class="w-3 h-3 bg-yellow-400 rounded-full animate-pulse"></div>
          <span>æ¥ç¶šç¢ºèªä¸­...</span>
        </div>
        <div id="balance" class="text-xl font-bold">æ®‹é«˜: èª­è¾¼ä¸­...</div>
      </div>
    </div>

    <!-- é€é‡‘ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="grid md:grid-cols-2 gap-6 mb-6">
      <!-- å³æ™‚é€é‡‘ -->
      <div class="bg-slate-800/50 backdrop-blur rounded-2xl p-6 border border-purple-500/30">
        <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
          âš¡ å³æ™‚é€é‡‘
        </h2>
        <form id="instantForm" class="space-y-4">
          <input type="email" id="instant_to" placeholder="é€é‡‘å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" required
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500">
          <input type="number" id="instant_amount" placeholder="é‡‘é¡ï¼ˆå††ï¼‰" required min="1"
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500">
          <input type="text" id="instant_note" placeholder="ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰"
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-blue-500">
          <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 py-4 rounded-xl font-bold transition shadow-lg">
            å³æ™‚é€é‡‘å®Ÿè¡Œ
          </button>
        </form>
      </div>

      <!-- éŠ€è¡ŒæŒ¯è¾¼ -->
      <div class="bg-slate-800/50 backdrop-blur rounded-2xl p-6 border border-purple-500/30">
        <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
          ğŸ¦ éŠ€è¡ŒæŒ¯è¾¼
        </h2>
        <form id="bankForm" class="space-y-4">
          <select id="bank_code" required class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
            <option value="">éŠ€è¡Œé¸æŠ</option>
            <option value="0001">ã¿ãšã»éŠ€è¡Œ</option>
            <option value="0005">ä¸‰è±UFJéŠ€è¡Œ</option>
            <option value="0009">ä¸‰äº•ä½å‹éŠ€è¡Œ</option>
            <option value="0010">ã‚ŠããªéŠ€è¡Œ</option>
          </select>
          <input type="text" id="bank_account" placeholder="å£åº§ç•ªå·ï¼ˆ7æ¡ï¼‰" required maxlength="7"
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <input type="text" id="bank_name" placeholder="å£åº§åç¾©" required
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <input type="number" id="bank_amount" placeholder="æŒ¯è¾¼é‡‘é¡" required min="1"
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <button type="submit" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 py-4 rounded-xl font-bold transition shadow-lg">
            éŠ€è¡ŒæŒ¯è¾¼å®Ÿè¡Œ
          </button>
        </form>
      </div>

      <!-- æš—å·è³‡ç”£ -->
      <div class="bg-slate-800/50 backdrop-blur rounded-2xl p-6 border border-purple-500/30">
        <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
          â‚¿ æš—å·è³‡ç”£é€é‡‘
        </h2>
        <form id="cryptoForm" class="space-y-4">
          <select id="crypto_currency" required class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
            <option value="BTC">Bitcoin (BTC)</option>
            <option value="ETH">Ethereum (ETH)</option>
            <option value="USDT">Tether (USDT)</option>
          </select>
          <input type="text" id="crypto_address" placeholder="é€é‡‘å…ˆã‚¢ãƒ‰ãƒ¬ã‚¹" required
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <input type="number" step="0.00001" id="crypto_amount" placeholder="æ•°é‡" required
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <button type="submit" class="w-full bg-gradient-to-r from-orange-600 to-yellow-600 hover:from-orange-700 hover:to-yellow-700 py-4 rounded-xl font-bold transition shadow-lg">
            æš—å·è³‡ç”£é€é‡‘
          </button>
        </form>
      </div>

      <!-- å›½éš›é€é‡‘ -->
      <div class="bg-slate-800/50 backdrop-blur rounded-2xl p-6 border border-purple-500/30">
        <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
          ğŸŒ å›½éš›é€é‡‘
        </h2>
        <form id="intlForm" class="space-y-4">
          <select id="intl_currency" required class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
            <option value="USD">ç±³ãƒ‰ãƒ« (USD)</option>
            <option value="EUR">ãƒ¦ãƒ¼ãƒ­ (EUR)</option>
            <option value="GBP">ãƒãƒ³ãƒ‰ (GBP)</option>
          </select>
          <input type="text" id="intl_recipient" placeholder="å—å–äººå" required
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <input type="number" id="intl_amount" placeholder="é‡‘é¡ï¼ˆå††ï¼‰" required min="1"
            class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg">
          <button type="submit" class="w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 py-4 rounded-xl font-bold transition shadow-lg">
            å›½éš›é€é‡‘å®Ÿè¡Œ
          </button>
        </form>
      </div>
    </div>

    <!-- çµæœè¡¨ç¤º -->
    <div id="result" class="hidden bg-slate-800/50 backdrop-blur rounded-2xl p-6 border border-green-500/30 mb-6">
      <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
        âœ… å–å¼•çµæœ
      </h3>
      <pre id="resultData" class="bg-slate-900 p-4 rounded-lg overflow-auto text-sm"></pre>
    </div>

    <!-- ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± -->
    <div class="grid md:grid-cols-3 gap-4">
      <div class="bg-slate-800/50 backdrop-blur rounded-xl p-4 border border-slate-700">
        <div class="text-sm text-slate-400 mb-1">Railway API</div>
        <div id="railway_status" class="font-mono text-xs">ç¢ºèªä¸­...</div>
      </div>
      <div class="bg-slate-800/50 backdrop-blur rounded-xl p-4 border border-slate-700">
        <div class="text-sm text-slate-400 mb-1">ç·å–å¼•æ•°</div>
        <div id="tx_count" class="text-2xl font-bold">0</div>
      </div>
      <div class="bg-slate-800/50 backdrop-blur rounded-xl p-4 border border-slate-700">
        <div class="text-sm text-slate-400 mb-1">æœ€çµ‚å–å¼•</div>
        <div id="last_tx" class="font-mono text-xs">-</div>
      </div>
    </div>
  </div>

  <script>
    const API = 'https://hopeful-liberation-production-9d00.up.railway.app';
    const USER_ID = 'TKG-OWNER-001';

    async function callAPI(endpoint, method = 'GET', data = null) {
      const opts = { method, headers: { 'Content-Type': 'application/json' } };
      if (data) opts.body = JSON.stringify(data);
      const res = await fetch(API + endpoint, opts);
      return res.json();
    }

    function showResult(data) {
      document.getElementById('result').classList.remove('hidden');
      document.getElementById('resultData').textContent = JSON.stringify(data, null, 2);
      
      if (data.status === 'completed') {
        alert(`âœ… å–å¼•å®Œäº†ï¼\nID: ${data.id}\né‡‘é¡: Â¥${data.amount?.toLocaleString() || 'N/A'}`);
      }
    }

    // åˆæœŸåŒ–
    (async () => {
      try {
        const health = await callAPI('/');
        const statusEl = document.getElementById('status');
        if (health.status === 'FULLY_OPERATIONAL') {
          statusEl.innerHTML = '<div class="w-3 h-3 bg-green-400 rounded-full"></div><span>âœ… æ¥ç¶šæˆåŠŸ</span>';
          document.getElementById('railway_status').textContent = health.status;
        }

        const balance = await callAPI(`/api/balance/${USER_ID}`);
        document.getElementById('balance').textContent = 
          `æ®‹é«˜: Â¥${balance.totalBalance.toLocaleString()}`;

        const history = await callAPI(`/api/transfers/${USER_ID}`);
        document.getElementById('tx_count').textContent = history.count;
        if (history.transactions[0]) {
          document.getElementById('last_tx').textContent = history.transactions[0].id;
        }
      } catch (e) {
        document.getElementById('status').innerHTML = 
          '<div class="w-3 h-3 bg-red-400 rounded-full"></div><span>âŒ æ¥ç¶šã‚¨ãƒ©ãƒ¼</span>';
      }
    })();

    // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
    document.getElementById('instantForm').onsubmit = async (e) => {
      e.preventDefault();
      const result = await callAPI('/api/transfer/instant', 'POST', {
        fromUserId: USER_ID,
        toIdentifier: document.getElementById('instant_to').value,
        amount: parseFloat(document.getElementById('instant_amount').value),
        note: document.getElementById('instant_note').value
      });
      showResult(result);
    };

    document.getElementById('bankForm').onsubmit = async (e) => {
      e.preventDefault();
      const result = await callAPI('/api/transfer/bank', 'POST', {
        fromAccountId: USER_ID,
        toBankCode: document.getElementById('bank_code').value,
        toAccountNumber: document.getElementById('bank_account').value,
        toAccountName: document.getElementById('bank_name').value,
        amount: parseFloat(document.getElementById('bank_amount').value)
      });
      showResult(result);
    };

    document.getElementById('cryptoForm').onsubmit = async (e) => {
      e.preventDefault();
      const result = await callAPI('/api/transfer/crypto', 'POST', {
        fromUserId: USER_ID,
        toAddress: document.getElementById('crypto_address').value,
        amount: parseFloat(document.getElementById('crypto_amount').value),
        currency: document.getElementById('crypto_currency').value
      });
      showResult(result);
    };

    document.getElementById('intlForm').onsubmit = async (e) => {
      e.preventDefault();
      const result = await callAPI('/api/transfer/international', 'POST', {
        fromUserId: USER_ID,
        country: 'US',
        recipientData: { name: document.getElementById('intl_recipient').value },
        amount: parseFloat(document.getElementById('intl_amount').value),
        fromCurrency: 'JPY',
        toCurrency: document.getElementById('intl_currency').value
      });
      showResult(result);
    };
  </script>
</body>
</html>
